define(function(require,exports,module){"use strict";var oop=require("../lib/oop");var TextHighlightRules=require("./text_highlight_rules").TextHighlightRules;var MarkdownHighlightRules=require("./markdown_highlight_rules").MarkdownHighlightRules;var SassHighlightRules=require("./scss_highlight_rules").ScssHighlightRules;var LessHighlightRules=require("./less_highlight_rules").LessHighlightRules;var CoffeeHighlightRules=require("./coffee_highlight_rules").CoffeeHighlightRules;var JavaScriptHighlightRules=require("./javascript_highlight_rules").JavaScriptHighlightRules;function mixin_embed(tag,prefix){return{token:"entity.name.function.jade",regex:"^\\s*\\:"+tag,next:prefix+"start"}}var JadeHighlightRules=function(){var escapedRe="\\\\(?:x[0-9a-fA-F]{2}|"+"u[0-9a-fA-F]{4}|"+"[0-2][0-7]{0,2}|"+"3[0-6][0-7]?|"+"37[0-7]?|"+"[4-7][0-7]?|"+".)";this.$rules={start:[{token:"keyword.control.import.include.jade",regex:"\\s*\\binclude\\b"},{token:"keyword.other.doctype.jade",regex:"^!!!\\s*(?:[a-zA-Z0-9-_]+)?"},{token:"punctuation.section.comment",regex:"^\\s*//(?:\\s*[^-\\s]|\\s+\\S)(?:.*$)"},{onMatch:function(value,currentState,stack){stack.unshift(this.next,value.length-2,currentState);return"comment"},regex:/^\s*\/\//,next:"comment_block"},mixin_embed("markdown","markdown-"),mixin_embed("sass","sass-"),mixin_embed("less","less-"),mixin_embed("coffee","coffee-"),{token:["storage.type.function.jade","entity.name.function.jade","punctuation.definition.parameters.begin.jade","variable.parameter.function.jade","punctuation.definition.parameters.end.jade"],regex:"^(\\s*mixin)( [\\w\\-]+)(\\s*\\()(.*?)(\\))"},{token:["storage.type.function.jade","entity.name.function.jade"],regex:"^(\\s*mixin)( [\\w\\-]+)"},{token:"source.js.embedded.jade",regex:"^\\s*(?:-|=|!=)",next:"js-start"},{token:"string.interpolated.jade",regex:"[#!]\\{[^\\}]+\\}"},{token:"meta.tag.any.jade",regex:/^\s*(?!\w+\:)(?:[\w]+|(?=\.|#)])/,next:"tag_single"},{token:"suport.type.attribute.id.jade",regex:"#\\w+"},{token:"suport.type.attribute.class.jade",regex:"\\.\\w+"},{token:"punctuation",regex:"\\s*(?:\\()",next:"tag_attributes"}],comment_block:[{regex:/^\s*/,onMatch:function(value,currentState,stack){if(value.length<=stack[1]){stack.shift();stack.shift();this.next=stack.shift();return"text"}else{this.next="";return"comment"}},next:"start"},{defaultToken:"comment"}],tag_single:[{token:"entity.other.attribute-name.class.jade",regex:"\\.[\\w-]+"},{token:"entity.other.attribute-name.id.jade",regex:"#[\\w-]+"},{token:["text","punctuation"],regex:"($)|((?!\\.|#|=|-))",next:"start"}],tag_attributes:[{token:"string",regex:"'(?=.)",next:"qstring"},{token:"string",regex:'"(?=.)',next:"qqstring"},{token:"entity.other.attribute-name.jade",regex:"\\b[a-zA-Z\\-:]+"},{token:["entity.other.attribute-name.jade","punctuation"],regex:"\\b([a-zA-Z:\\.-]+)(=)",next:"attribute_strings"},{token:"punctuation",regex:"\\)",next:"start"}],attribute_strings:[{token:"string",regex:"'(?=.)",next:"qstring"},{token:"string",regex:'"(?=.)',next:"qqstring"}],qqstring:[{token:"constant.language.escape",regex:escapedRe},{token:"string",regex:'[^"\\\\]+'},{token:"string",regex:"\\\\$",next:"qqstring"},{token:"string",regex:'"|$',next:"tag_attributes"}],qstring:[{token:"constant.language.escape",regex:escapedRe},{token:"string",regex:"[^'\\\\]+"},{token:"string",regex:"\\\\$",next:"qstring"},{token:"string",regex:"'|$",next:"tag_attributes"}]};this.embedRules(JavaScriptHighlightRules,"js-",[{token:"text",regex:".$",next:"start"}])};oop.inherits(JadeHighlightRules,TextHighlightRules);exports.JadeHighlightRules=JadeHighlightRules});