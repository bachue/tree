define(function(require,exports,module){var SemanticHighlighter=exports.SemanticHighlighter=function(ast){this.tokens={};this.getTokens=function(){this.visit(ast);return this.tokens};this.EQName=this.NCName=function(node){var row=node.pos.sl;this.tokens[row]=this.tokens[row]===undefined?[]:this.tokens[row];node.pos.type="support.function";this.tokens[row].push(node.pos);return true};this.visit=function(node){var name=node.name;var skip=false;if(typeof this[name]==="function")skip=this[name](node)===true?true:false;if(!skip){this.visitChildren(node)}};this.visitChildren=function(node,handler){for(var i=0;i<node.children.length;i++){var child=node.children[i];if(handler!==undefined&&typeof handler[child.name]==="function"){handler[child.name](child)}else{this.visit(child)}}}}});